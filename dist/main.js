!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="dist/",i(i.s=4)}([function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",s=t[3];if(!s)return i;if(e&&"function"==typeof btoa){var n=(o=s,a=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),r=s.sources.map((function(t){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(t," */")}));return[i].concat(r).concat([n]).join("\n")}var o,a,c;return[i].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,s){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(s)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(n[o]=!0)}for(var a=0;a<t.length;a++){var c=[].concat(t[a]);s&&n[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),e.push(c))}},e}},function(t,e,i){var s=i(2),n=i(3);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var r={insert:"head",singleton:!1};s(n,r);t.exports=n.locals||{}},function(t,e,i){"use strict";var s,n=function(){return void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s},r=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),o=[];function a(t){for(var e=-1,i=0;i<o.length;i++)if(o[i].identifier===t){e=i;break}return e}function c(t,e){for(var i={},s=[],n=0;n<t.length;n++){var r=t[n],c=e.base?r[0]+e.base:r[0],h=i[c]||0,u="".concat(c," ").concat(h);i[c]=h+1;var l=a(u),f={css:r[1],media:r[2],sourceMap:r[3]};-1!==l?(o[l].references++,o[l].updater(f)):o.push({identifier:u,updater:y(f,e),references:1}),s.push(u)}return s}function h(t){var e=document.createElement("style"),s=t.attributes||{};if(void 0===s.nonce){var n=i.nc;n&&(s.nonce=n)}if(Object.keys(s).forEach((function(t){e.setAttribute(t,s[t])})),"function"==typeof t.insert)t.insert(e);else{var o=r(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var u,l=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function f(t,e,i,s){var n=i?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(t.styleSheet)t.styleSheet.cssText=l(e,n);else{var r=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(r,o[e]):t.appendChild(r)}}function d(t,e,i){var s=i.css,n=i.media,r=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}var m=null,p=0;function y(t,e){var i,s,n;if(e.singleton){var r=p++;i=m||(m=h(e)),s=f.bind(null,i,r,!1),n=f.bind(null,i,r,!0)}else i=h(e),s=d.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return s(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;s(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=n());var i=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var s=0;s<i.length;s++){var n=a(i[s]);o[n].references--}for(var r=c(t,e),h=0;h<i.length;h++){var u=a(i[h]);0===o[u].references&&(o[u].updater(),o.splice(u,1))}i=r}}}},function(t,e,i){"use strict";i.r(e);var s=i(0),n=i.n(s)()(!1);n.push([t.i,"*{padding:0;margin:0;box-sizing:border-box}body{position:fixed;top:0;left:0;right:0;bottom:0;overflow:hidden;display:flex;background-color:#222}.wrapper{position:relative;height:100%;width:100%}canvas{position:absolute;top:0;left:0;right:0;bottom:0;margin:auto;max-width:100%;max-height:100%;height:auto;width:auto;border:1px solid #aaa}",""]),e.default=n},function(t,e,i){"use strict";i.r(e);i(1);function s(t,e){var i=t.x,s=t.x+t.width,n=t.y,r=t.y+t.height;return e.x+e.width>i&&e.x<s&&e.y+e.height>n&&e.y<r}function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function r(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){h(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l={canvas:void 0,ctx:void 0,width:720,height:1280,movement:{x:0,y:0,positions:{start:{},move:{},origin:{}},styles:{},init:function(){var t=this;["mousedown","mousemove","mouseup","mouseleave","touchstart","touchmove","touchend"].forEach((function(e){f.canvas.addEventListener(e,(function(e){t.setPositions(e)}))})),["load","resize"].forEach((function(e){window.addEventListener(e,(function(){t.setStyles(getComputedStyle(f.canvas))}))})),this.setPositionsDefault()},setPositions:function(t){var e=this.getPositions(t),i=e.x,s=e.y;i=i||this.positions.move.x||this.x,s=s||this.positions.move.y||this.y,["mousedown","touchstart"].includes(t.type)&&(this.positions.start.x=i,this.positions.start.y=s,this.positions.move.x=i,this.positions.move.y=s,this.positions.origin.x=this.x,this.positions.origin.y=this.y),["mousemove","touchmove"].includes(t.type)&&(this.positions.move.x=i,this.positions.move.y=s),["mouseup","touchend","mouseleave"].includes(t.type)&&this.clearPositions(),["mousemove","touchmove"].includes(t.type)&&(this.positions.start.x||this.positions.start.y)&&(this.x=this.positions.origin.x+1.15*(this.positions.move.x-this.positions.start.x),this.y=this.positions.origin.y+1.15*(this.positions.move.y-this.positions.start.y),this.y-f.user.height/2<0&&(this.y=f.user.height/2),f.user.height/2>f.height-this.y&&(this.y=f.height-f.user.height/2),f.user.width/2>this.x&&(this.x=f.user.width/2),f.user.width/2>f.width-this.x&&(this.x=f.width-f.user.width/2))},clearPositions:function(){this.positions.start.x=null,this.positions.start.y=null,this.positions.move.x=null,this.positions.move.y=null,this.positions.origin.x=null,this.positions.origin.y=null},setPositionsDefault:function(){this.x=360,this.y=1100,this.clearPositions()},getPositions:function(t){var e,i,s=this.styles,n=s.width,r=s.height;if(["touchstart","touchmove"].includes(t.type)){var o=t.touches[0];e=o.clientX-o.target.offsetLeft,i=o.clientY-o.target.offsetTop}else e=t.layerX,i=t.layerY;var a=e/n*100,c=i/r*100;return{x:f.width/100*a,y:f.height/100*c}},setStyles:function(t){this.styles.width=parseFloat(t.width),this.styles.height=parseFloat(t.height)}},user:{x:314,y:1e3,ratio:4,width:92,height:503/4,killing:!1,frame:0,render:function(t){var e=this.killing?f.assets.user_die:f.assets.user,i=e.img,s=e.frames,n=i.width/s*this.frame,r=i.width/s,o=i.height;t.drawImage(i,n,0,r,o,this.x,this.y,this.width,this.height)},kill:function(t){var e=this;return new Promise((function(i){e.killing=!0,e.frame=0;var s=setInterval((function(){++e.frame>=t.frames&&(clearInterval(s),i())}),1e3/24)}))}},enemy:{levelUpTimer:null,list:[],xp:{normal:10,stronger:20,boss:30},move:function(){this.list.forEach((function(t){t.x+=t.dx,t.y+=t.dy,t.xDir?t.dx+=.04:t.dx-=.04,Math.abs(t.dx)>1&&(t.xDir=!t.xDir),s(r({},t),r({},f.user))&&!f.user.killing&&f.dieRestart(),t.y>f.height-t.height&&!f.user.killing&&f.dieRestart()}))},add:function(){for(var t=0;t<5;t++){var e=this.getRandomType(),i=f.assets["enemy_".concat(e)].img,s=i.width,n=i.height;s/=4,n/=4;var r=Math.floor(this.xp[e]*this.getCoef());this.list.push({type:e,xp:r,xp_total:r,x:142*t+40,y:-n,dy:.75,dx:0,killing:!1,frame:0,width:s,height:n})}},getCoef:function(){var t=1;return f.info.scores>10&&(t=1.5),f.info.scores>20&&(t=2),f.info.scores>30&&(t=3),f.info.scores>40&&(t=4),f.info.scores>50&&(t=5),t},getRandomType:function(){return Math.random()<.8?"normal":Math.random()<.8?"stronger":"boss"},hit:function(t){var e=this,i=this.list[t];i.xp-=1,i.xp<=0&&!i.killing&&("normal"!==i.type&&f.bullet.up(),this.levelUpTimer=clearInterval(this.levelUpTimer),this.levelUpTimer=setInterval((function(){f.bullet.down()}),1e4),i.killing=!0,i.type="".concat(i.type,"_die"),this.removeEnemiesTimer=clearTimeout(this.removeEnemiesTimer),this.kill(t).then((function(){i.must_remove=!0,e.removeEnemiesTimer=setTimeout((function(){e.list=e.list.filter((function(t){return!t.must_remove})),0===e.list.length&&e.add()}),1e3/24)})),f.info.scoreUp())},kill:function(t){var e=this;return new Promise((function(i){var s=e.list[t],n=f.assets["enemy_"+s.type].frames,r=setInterval((function(){++s.frame>=n&&(clearInterval(r),i())}),1e3/24)}))},render:function(t){this.list.forEach((function(e){var i=f.assets["enemy_".concat(e.type)],s=i.img,n=i.frames,r=s.width/n*e.frame,o=s.width/n,a=s.height;if(t.drawImage(s,r,0,o,a,e.x,e.y,e.width,e.height),!(e.xp<=0)){var c=100/e.xp_total*e.xp,h=e.width/100*c,u=e.x,l=e.y-10,d="#fff";c<50&&(d="#f90"),c<20&&(d="#f00"),t.beginPath(),t.fillStyle="rgba(255,255,255,.4)",t.rect(u,l,e.width,2),t.fill(),t.beginPath(),t.fillStyle=d,t.rect(u,l,h,2),t.fill()}}))},enemiesGoBack:function(){var t=this;return new Promise((function(e){var i=0;t.list.forEach((function(t){t._dy=t.dy,t.dy=-1,i<t.height&&(i=t.height)}));var s=setInterval((function(){t.list.forEach((function(t){t.dy*=1.45})),t.list.reduce((function(t,e){return e.y>t?e.y:t}),-i)<=-i&&(s=clearInterval(s),t.list.forEach((function(t){t.dy=t._dy,t.y=0-1.5*t.height})),e())}),1e3/24)}))}},bullet:{x:0,y:0,width:20,height:58,offset:.75,list:[],createTimeout:null,type:"default",types:{default:{interval:300,speed:20,count:1},secondary:{interval:200,speed:40,count:2},fast:{interval:150,speed:50,count:3}},levels:["default","secondary","fast"],get create_interval(){return this.types[this.type].interval},get speed(){return this.types[this.type].speed},get count(){return this.types[this.type].count},start:function(){var t=this;this.stop(),this.createTimeout=setTimeout((function(){t.add(),t.start()}),this.create_interval)},stop:function(){this.createTimeout=clearTimeout(this.createTimeout)},render:function(t){this.list.forEach((function(e){t.drawImage(f.assets.bullet,e.x,e.y,e.width,e.height)}))},add:function(){for(var t=this.x-this.width*this.offset*this.count+this.width*this.offset,e=0;e<this.count;e++)t+=this.width*this.offset*2*!!e,this.list.push({x:t,y:this.y+15*this.count,dx:0,dy:this.speed,width:this.width,height:this.height,readyToRemove:!1})},removeIfNeeded:function(){this.list=this.list.filter((function(t){return!t.readyToRemove}))},move:function(){this.list.forEach((function(t){if(t.y-=t.dy,t.x-=t.dx,t.y+t.height<0)t.readyToRemove=!0;else for(var e in f.enemy.list){var i=f.enemy.list[e];if(!i.killing&&s(c({},i),c({},t)))return f.enemy.hit(e),void(t.readyToRemove=!0)}}))},up:function(){var t=this.levels.indexOf(this.type);++t>this.levels.length-1&&(t=this.levels.length-1),this.type=this.levels[t]},down:function(){var t=this.levels.indexOf(this.type);--t<0&&(t=0),this.type=this.levels[t]}},info:{scores:null,recordScores:null,lives:null,render:function(t){var e=f.height-90;t.beginPath(),t.fillStyle="rgba(0,0,0,.5)",t.rect(0,e,150,90),t.fill(),t.beginPath(),t.fillStyle="#fff",t.font="bold ".concat(20,'px "Trebuchet MS"'),["Lives: ".concat(this.lives),"Scores: ".concat(this.scores),"Record: ".concat(this.recordScores)].forEach((function(i,s){t.fillText(i,10,e+10+20*(s+1),130)})),t.fill()},scoreUp:function(){++this.scores>this.recordScores&&(this.recordScores=this.scores,localStorage.recordScores=this.scores)},setDefault:function(){this.lives=5,this.scores=0,this.recordScores=localStorage.recordScores||0}},assets:{bg:"assets/img/bg.jpg",user:{img:"assets/img/user-starship.png",frames:1},user_die:{img:"assets/img/user-starship-die-sprite.png",frames:10},bullet:"assets/img/bullet2.png",enemy_normal:{img:"assets/img/enemy-starship-normal.png",frames:1},enemy_stronger:{img:"assets/img/enemy-starship-stronger.png",frames:1},enemy_boss:{img:"assets/img/enemy-starship-boss.png",frames:1},enemy_normal_die:{img:"assets/img/enemy-starship-normal-die-sprite.png",frames:10},enemy_stronger_die:{img:"assets/img/enemy-starship-stronger-die-sprite.png",frames:10},enemy_boss_die:{img:"assets/img/enemy-starship-boss-die-sprite.png",frames:10}},init:function(){var t=this;this.canvas=document.getElementById("game"),this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),this.load().then((function(){t.movement.init(),t.info.setDefault(),t.setPositions(),t.start()}))},load:function(){var t=this;return new Promise((function(e){var i=Object.keys(t.assets).length,s=0;for(var n in t.assets){var r=new Image;"object"==u(t.assets[n])?(r.src=t.assets[n].img,t.assets[n].img=r):(r.src=t.assets[n],t.assets[n]=r),r.onload=function(){i>++s&&e()}}}))},start:function(){this.run(),this.bullet.start(),this.enemy.add()},run:function(){var t=this;this.update(),this.render(),requestAnimationFrame((function(){t.run()}))},update:function(){this.bullet.move(),this.bullet.removeIfNeeded(),this.setPositions(),this.enemy.move()},render:function(){this.ctx.drawImage(this.assets.bg,0,0,this.width,this.height),this.user.render(this.ctx),this.enemy.render(this.ctx),this.bullet.render(this.ctx),this.info.render(this.ctx)},setPositions:function(){this.user.x=this.movement.x-this.user.width/2,this.user.y=this.movement.y-this.user.height/2,this.bullet.x=this.user.x+this.user.width/2-this.bullet.width/2,this.bullet.y=this.user.y-this.bullet.height},dieRestart:function(){var t=this;this.bullet.stop(),this.user.kill(this.assets.user_die).then((function(){l.enemy.enemiesGoBack().then((function(){t.info.lives<=0&&t.info.setDefault(),t.user.killing=!1,t.user.frame=0,t.movement.setPositionsDefault(),t.info.lives-=1,t.bullet.start()}))}))}},f=e.default=l;l.init()}]);